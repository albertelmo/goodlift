<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>GoodLift</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#1976d2">
    <meta name="google" content="notranslate">
    <link rel="manifest" href="/manifest.json">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/adminDayCalendar.css">
    <link rel="stylesheet" href="css/adminWeekCalendar.css">
    <link rel="stylesheet" href="css/app-user.css">
    <link rel="stylesheet" href="css/consultation.css">
</head>
<body>
    <div id="old-header" style="display:flex;align-items:center;justify-content:space-between;margin-bottom:0;">
      <div style="display:flex;align-items:center;gap:8px;">
        <img id="mainLogo" src="img/logo.png" alt="GoodLift 로고" style="height:38px;cursor:pointer; margin-top:16px; margin-bottom:8px;" />
        <button id="secretBtn" title="관리자 기능" style="display:none;background:none;border:none;cursor:pointer;font-size:12px;color:#666;padding:4px;border-radius:4px;transition:all 0.2s;" aria-label="관리자 기능">🔒</button>
      </div>
      <div class="header-btns">
        <button id="switchToAppUserBtn" class="header-text-btn" title="유저앱 화면으로 전환" style="display:none;" aria-label="유저앱 화면으로 전환">유저앱</button>
        <button id="consultationBtn" class="consultation-list-btn" title="상담목록" style="display:none;" aria-label="상담목록">상담목록</button>
        <button id="settingsBtn" class="header-text-btn" title="설정" style="display:none;" aria-label="설정">설정</button>
        <button id="logoutBtn" class="header-text-btn" title="로그아웃" style="display:none;" aria-label="로그아웃">로그아웃</button>
      </div>
    </div>
    <div id="authSection">
        <div id="loginSection" class="auth-container">
            <div class="auth-card">
                <div class="auth-header">
                    <h2>환영합니다</h2>
                    <p>GoodLift에 로그인하세요</p>
                </div>
                <form id="loginForm" autocomplete="on" class="auth-form">
                    <div class="form-group">
                        <label for="login-username">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                <circle cx="12" cy="7" r="4"></circle>
                            </svg>
                            아이디
                        </label>
                        <input type="text" id="login-username" name="username" autocomplete="username" placeholder="아이디를 입력하세요" required>
                    </div>
                    <div class="form-group">
                        <label for="login-password">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                                <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
                            </svg>
                            비밀번호
                        </label>
                        <input type="password" id="login-password" name="password" autocomplete="current-password" placeholder="비밀번호를 입력하세요" required>
                    </div>
                    <button type="submit" class="auth-btn-primary">
                        <span>로그인</span>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M5 12h14M12 5l7 7-7 7"></path>
                        </svg>
                    </button>
                </form>
                <div id="login-result" class="auth-result"></div>
                <div class="auth-footer">
                    <p>계정이 없으신가요?</p>
                    <button type="button" id="showSignupBtn" class="auth-link-btn">회원가입</button>
                </div>
            </div>
        </div>
        <div id="signupSection" class="auth-container" style="display:none;">
            <div class="auth-card">
                <div class="auth-header">
                    <h2>회원가입</h2>
                    <p>새로운 계정을 만들어보세요</p>
                </div>
                <div id="signupForm" class="auth-form">
                    <div class="form-group">
                        <label for="signup-username">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                <circle cx="12" cy="7" r="4"></circle>
                            </svg>
                            아이디
                        </label>
                        <input type="text" id="signup-username" autocomplete="off" placeholder="사용할 아이디를 입력하세요" required>
                        <div id="username-check-result" class="username-check-result"></div>
                    </div>
                    <div class="form-group">
                        <label for="signup-password">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                                <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
                            </svg>
                            비밀번호
                        </label>
                        <input type="password" id="signup-password" autocomplete="off" data-lpignore="true" placeholder="비밀번호를 입력하세요" required>
                    </div>
                    <div class="form-group">
                        <label for="signup-password2">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                                <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
                            </svg>
                            비밀번호 확인
                        </label>
                        <input type="password" id="signup-password2" autocomplete="off" data-lpignore="true" placeholder="비밀번호를 다시 입력하세요" required>
                    </div>
                    <div class="form-group">
                        <label for="signup-name">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                <circle cx="12" cy="7" r="4"></circle>
                            </svg>
                            이름
                        </label>
                        <input type="text" id="signup-name" placeholder="이름을 입력하세요" required>
                </div>
                    <div class="form-group">
                        <label for="signup-phone">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>
                            </svg>
                            전화번호
                        </label>
                        <input type="tel" id="signup-phone" placeholder="010-1234-5678" required>
                </div>
                    <button type="button" id="signup-submit-btn" class="auth-btn-primary">
                        <span>회원가입</span>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M5 12h14M12 5l7 7-7 7"></path>
                        </svg>
                    </button>
                </div>
                <div id="signup-result" class="auth-result"></div>
                <div class="auth-footer">
                    <p>이미 계정이 있으신가요?</p>
                    <button type="button" id="backToLoginBtn" class="auth-link-btn">로그인</button>
                </div>
                </div>
        </div>
    </div>
    <div id="accountSettingsModalBg" style="display:none;position:fixed;z-index:1000;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.4);backdrop-filter:blur(2px);"></div>
    <div id="accountSettingsModal" style="display:none;position:fixed;z-index:1001;top:50%;left:50%;transform:translate(-50%,-50%);background:#fff;padding:24px;border-radius:12px;box-shadow:0 4px 20px rgba(0,0,0,0.15);min-width:300px;max-width:360px;max-height:90vh;overflow-y:auto;">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;padding-bottom:12px;border-bottom:1px solid #e3f2fd;">
        <h3 style="margin:0;color:#1976d2;font-size:1rem;font-weight:600;">설정</h3>
        <button type="button" id="closeAccountSettingsBtn" style="background:transparent;border:none;color:#666;font-size:1.5rem;cursor:pointer;padding:0;width:24px;height:24px;display:flex;align-items:center;justify-content:center;line-height:1;" title="닫기">×</button>
      </div>
      
      <!-- 트레이너 옵션 섹션 (트레이너인 경우만 표시) -->
      <div id="trainerOptionsSection" style="display:none;margin-bottom:24px;padding-bottom:20px;border-bottom:1px solid #e3f2fd;">
        <h4 style="margin:0 0 16px 0;color:#333;font-size:0.95rem;font-weight:600;">트레이너 옵션</h4>
        <div style="display:flex;flex-direction:column;gap:12px;">
          <div style="display:flex;justify-content:space-between;align-items:center;">
            <span style="font-size:0.9rem;color:#666;">VIP 회원 기능</span>
            <button type="button" id="trainerVipToggle" style="background:#f5f5f5;color:#666;border:1px solid #666;padding:4px 12px;border-radius:16px;cursor:pointer;font-size:0.8rem;font-weight:500;white-space:nowrap;transition:all 0.2s;">OFF</button>
          </div>
          <div style="display:flex;justify-content:space-between;align-items:center;">
            <span style="font-size:0.9rem;color:#666;">30분 세션 기능</span>
            <button type="button" id="trainer30minToggle" style="background:#f5f5f5;color:#666;border:1px solid #666;padding:4px 12px;border-radius:16px;cursor:pointer;font-size:0.8rem;font-weight:500;white-space:nowrap;transition:all 0.2s;">OFF</button>
          </div>
          <div style="display:flex;justify-content:space-between;align-items:center;">
            <span style="font-size:0.9rem;color:#666;">월간보기 기본값</span>
            <button type="button" id="trainerMonthlyViewToggle" style="background:#f5f5f5;color:#666;border:1px solid #666;padding:4px 12px;border-radius:16px;cursor:pointer;font-size:0.8rem;font-weight:500;white-space:nowrap;transition:all 0.2s;">OFF</button>
          </div>
        </div>
        <div id="trainerOptionsResult" style="min-height:20px;margin-top:12px;font-size:0.85rem;text-align:center;"></div>
      </div>
      
      <!-- 비밀번호 변경 섹션 -->
      <div>
        <h4 style="margin:0 0 16px 0;color:#333;font-size:0.95rem;font-weight:600;">비밀번호 변경</h4>
        <form id="changePwForm">
          <div style="margin-bottom:12px;">
            <label for="currentPw" style="display:block;margin-bottom:4px;font-weight:600;color:#333;font-size:0.9rem;">
              현재 비밀번호 <span style="color:#d32f2f;">*</span>
            </label>
            <input type="password" id="currentPw" name="currentPw" required
                   style="width:280px;max-width:100%;padding:8px 12px;border:1px solid #ddd;border-radius:6px;font-size:0.95rem;box-sizing:border-box;transition:border-color 0.2s;"
                   onfocus="this.style.borderColor='#1976d2';" 
                   onblur="this.style.borderColor='#ddd';">
          </div>
          <div style="margin-bottom:12px;">
            <label for="newPw" style="display:block;margin-bottom:4px;font-weight:600;color:#333;font-size:0.9rem;">
              새 비밀번호 <span style="color:#d32f2f;">*</span>
            </label>
            <input type="password" id="newPw" name="newPw" required
                   style="width:280px;max-width:100%;padding:8px 12px;border:1px solid #ddd;border-radius:6px;font-size:0.95rem;box-sizing:border-box;transition:border-color 0.2s;"
                   onfocus="this.style.borderColor='#1976d2';" 
                   onblur="this.style.borderColor='#ddd';">
          </div>
          <div style="margin-bottom:16px;">
            <label for="newPw2" style="display:block;margin-bottom:4px;font-weight:600;color:#333;font-size:0.9rem;">
              새 비밀번호 확인 <span style="color:#d32f2f;">*</span>
            </label>
            <input type="password" id="newPw2" name="newPw2" required
                   style="width:280px;max-width:100%;padding:8px 12px;border:1px solid #ddd;border-radius:6px;font-size:0.95rem;box-sizing:border-box;transition:border-color 0.2s;"
                   onfocus="this.style.borderColor='#1976d2';" 
                   onblur="this.style.borderColor='#ddd';">
          </div>
          <div id="changePwResult" style="min-height:20px;margin-bottom:12px;font-size:0.9rem;text-align:center;"></div>
          <div style="display:flex;gap:10px;justify-content:flex-end;">
            <button type="button" id="closeAccountSettingsBtn2" style="background:#eee;color:#1976d2;border:none;padding:8px 16px;border-radius:6px;font-size:0.9rem;font-weight:500;cursor:pointer;transition:background-color 0.2s;"
                    onmouseover="this.style.background='#e0e0e0';" 
                    onmouseout="this.style.background='#eee';">취소</button>
            <button type="submit" style="background:#1976d2;color:#fff;border:none;padding:8px 16px;border-radius:6px;font-size:0.9rem;font-weight:600;cursor:pointer;transition:background-color 0.2s;"
                    onmouseover="this.style.background='#1565c0';" 
                    onmouseout="this.style.background='#1976d2';">비밀번호 변경</button>
          </div>
        </form>
      </div>
    </div>

    <!-- 비밀번호 입력 모달 -->
    <div id="secretPasswordModalBg" style="display:none;position:fixed;z-index:1000;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.25);"></div>
    <div id="secretPasswordModal" style="display:none;position:fixed;z-index:1001;top:50%;left:50%;transform:translate(-50%,-50%);background:#fff;padding:32px 28px 24px 28px;border-radius:14px;box-shadow:0 8px 32px #1976d240;min-width:320px;max-width:90vw;">
      <h3 style="margin-top:0;margin-bottom:18px;color:#d32f2f;font-size:1.15rem;">관리자 인증</h3>
      <form id="secretPasswordForm">
        <div class="form-row">
          <label for="secretPassword">관리자 비밀번호</label>
          <input type="password" id="secretPassword" name="secretPassword" required>
        </div>
        <div id="secretPasswordResult" style="min-height:22px;color:#d32f2f;margin-bottom:8px;"></div>
        <div style="display:flex;gap:10px;justify-content:flex-end;">
          <button type="button" id="closeSecretPasswordBtn" style="background:#eee;color:#1976d2;">취소</button>
          <button type="submit">확인</button>
        </div>
      </form>
    </div>

    <!-- 매출 수정/삭제 모달 -->
    <div id="sales-edit-modal-bg" style="display:none;position:fixed;z-index:1000;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.25);"></div>
    <div id="sales-edit-modal" style="display:none;position:fixed;z-index:1001;top:50%;left:50%;transform:translate(-50%,-50%);background:#fff;padding:12px;border-radius:12px;box-shadow:0 8px 32px rgba(0,0,0,0.2);width:240px;max-width:calc(100vw - 32px);max-height:90vh;overflow-y:auto;">
      <h3 style="margin-top:0;margin-bottom:10px;color:#1976d2;font-size:1rem;">매출 내역 수정</h3>
      <form id="sales-edit-form">
        <div style="margin-bottom:6px;">
          <label style="display:block;margin-bottom:1px;font-size:0.8rem;color:#666;font-weight:600;">날짜</label>
          <input type="date" id="sales-edit-date" required style="width:200px;max-width:100%;padding:4px 6px;border:1px solid #ddd;border-radius:4px;font-size:0.85rem;" />
        </div>
        <div style="margin-bottom:6px;">
          <label style="display:block;margin-bottom:1px;font-size:0.8rem;color:#666;font-weight:600;">회원명</label>
          <input type="text" id="sales-edit-member-name" required style="width:200px;max-width:100%;padding:4px 6px;border:1px solid #ddd;border-radius:4px;font-size:0.85rem;" />
        </div>
        <div style="margin-bottom:6px;">
          <label style="display:flex;align-items:center;gap:6px;font-size:0.8rem;color:#666;font-weight:600;">
            <input type="checkbox" id="sales-edit-is-new" style="width:16px;height:16px;cursor:pointer;" />
            <span>신규</span>
          </label>
        </div>
        <div style="margin-bottom:6px;">
          <label style="display:block;margin-bottom:1px;font-size:0.8rem;color:#666;font-weight:600;">회원권</label>
          <input type="text" id="sales-edit-membership" style="width:200px;max-width:100%;padding:4px 6px;border:1px solid #ddd;border-radius:4px;font-size:0.85rem;" />
        </div>
        <div style="margin-bottom:6px;">
          <label style="display:block;margin-bottom:1px;font-size:0.8rem;color:#666;font-weight:600;">결제방법</label>
          <select id="sales-edit-payment-method" style="width:200px;max-width:100%;padding:4px 6px;border:1px solid #ddd;border-radius:4px;font-size:0.85rem;">
            <option value="">선택하세요</option>
            <option value="카드">카드</option>
            <option value="계좌이체">계좌이체</option>
            <option value="현금">현금</option>
            <option value="매니저">매니저</option>
            <option value="환불">환불</option>
          </select>
        </div>
        <div style="margin-bottom:6px;">
          <label style="display:block;margin-bottom:1px;font-size:0.8rem;color:#666;font-weight:600;">금액</label>
          <input type="text" id="sales-edit-amount" required style="width:200px;max-width:100%;padding:4px 6px;border:1px solid #ddd;border-radius:4px;font-size:0.85rem;" />
        </div>
        <div style="margin-bottom:8px;">
          <label style="display:block;margin-bottom:1px;font-size:0.8rem;color:#666;font-weight:600;">비고</label>
          <textarea id="sales-edit-notes" rows="2" style="width:200px;max-width:100%;padding:4px 6px;border:1px solid #ddd;border-radius:4px;font-size:0.85rem;resize:vertical;"></textarea>
        </div>
        <div id="sales-edit-result" style="min-height:16px;margin-bottom:6px;font-size:0.8rem;"></div>
        <div style="display:flex;gap:6px;justify-content:space-between;align-items:center;">
          <button type="button" id="sales-edit-delete-btn" style="background:#dc3545;color:#fff;border:none;padding:6px 12px;border-radius:4px;cursor:pointer;font-size:0.85rem;">삭제</button>
          <div style="display:flex;gap:6px;">
            <button type="button" id="sales-edit-cancel-btn" style="background:#eee;color:#333;border:none;padding:6px 12px;border-radius:4px;cursor:pointer;font-size:0.85rem;">취소</button>
            <button type="submit" style="background:#1976d2;color:#fff;border:none;padding:6px 12px;border-radius:4px;cursor:pointer;font-size:0.85rem;">저장</button>
          </div>
        </div>
      </form>
    </div>

    <!-- 매출 추가 모달 -->
    <div id="sales-add-modal-bg" style="display:none;position:fixed;z-index:1000;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.25);"></div>
    <div id="sales-add-modal" style="display:none;position:fixed;z-index:1001;top:50%;left:50%;transform:translate(-50%,-50%);background:#fff;padding:12px;border-radius:12px;box-shadow:0 8px 32px rgba(0,0,0,0.2);width:240px;max-width:calc(100vw - 32px);max-height:90vh;overflow-y:auto;">
      <h3 style="margin-top:0;margin-bottom:10px;color:#1976d2;font-size:1rem;">매출 내역 추가</h3>
      <form id="sales-add-form">
        <div style="margin-bottom:6px;">
          <label style="display:block;margin-bottom:1px;font-size:0.8rem;color:#666;font-weight:600;">날짜</label>
          <input type="date" id="sales-add-date" required style="width:200px;max-width:100%;padding:4px 6px;border:1px solid #ddd;border-radius:4px;font-size:0.85rem;" />
        </div>
        <div style="margin-bottom:6px;">
          <label style="display:block;margin-bottom:1px;font-size:0.8rem;color:#666;font-weight:600;">회원명</label>
          <input type="text" id="sales-add-member-name" required style="width:200px;max-width:100%;padding:4px 6px;border:1px solid #ddd;border-radius:4px;font-size:0.85rem;" />
        </div>
        <div style="margin-bottom:6px;">
          <label style="display:flex;align-items:center;gap:6px;font-size:0.8rem;color:#666;font-weight:600;">
            <input type="checkbox" id="sales-add-is-new" style="width:16px;height:16px;cursor:pointer;" />
            <span>신규</span>
          </label>
        </div>
        <div style="margin-bottom:6px;">
          <label style="display:block;margin-bottom:1px;font-size:0.8rem;color:#666;font-weight:600;">회원권</label>
          <input type="text" id="sales-add-membership" style="width:200px;max-width:100%;padding:4px 6px;border:1px solid #ddd;border-radius:4px;font-size:0.85rem;" />
        </div>
        <div style="margin-bottom:6px;">
          <label style="display:block;margin-bottom:1px;font-size:0.8rem;color:#666;font-weight:600;">결제방법</label>
          <select id="sales-add-payment-method" style="width:200px;max-width:100%;padding:4px 6px;border:1px solid #ddd;border-radius:4px;font-size:0.85rem;">
            <option value="">선택하세요</option>
            <option value="카드">카드</option>
            <option value="계좌이체">계좌이체</option>
            <option value="현금">현금</option>
            <option value="매니저">매니저</option>
            <option value="환불">환불</option>
          </select>
        </div>
        <div style="margin-bottom:6px;">
          <label style="display:block;margin-bottom:1px;font-size:0.8rem;color:#666;font-weight:600;">금액</label>
          <input type="text" id="sales-add-amount" required style="width:200px;max-width:100%;padding:4px 6px;border:1px solid #ddd;border-radius:4px;font-size:0.85rem;" />
        </div>
        <div style="margin-bottom:8px;">
          <label style="display:block;margin-bottom:1px;font-size:0.8rem;color:#666;font-weight:600;">비고</label>
          <textarea id="sales-add-notes" rows="2" style="width:200px;max-width:100%;padding:4px 6px;border:1px solid #ddd;border-radius:4px;font-size:0.85rem;resize:vertical;"></textarea>
        </div>
        <div id="sales-add-result" style="min-height:16px;margin-bottom:6px;font-size:0.8rem;"></div>
        <div style="display:flex;gap:6px;justify-content:flex-end;">
          <button type="button" id="sales-add-cancel-btn" style="background:#eee;color:#333;border:none;padding:6px 12px;border-radius:4px;cursor:pointer;font-size:0.85rem;">취소</button>
          <button type="submit" style="background:#1976d2;color:#fff;border:none;padding:6px 12px;border-radius:4px;cursor:pointer;font-size:0.85rem;">저장</button>
        </div>
      </form>
    </div>

    <!-- 매출 검색 모달 -->
    <div id="sales-search-modal-bg" style="display:none;position:fixed;z-index:1000;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.25);"></div>
    <div id="sales-search-modal" style="display:none;position:fixed;z-index:1001;top:50%;left:50%;transform:translate(-50%,-50%);background:#fff;padding:12px;border-radius:12px;box-shadow:0 8px 32px rgba(0,0,0,0.2);width:240px;max-width:calc(100vw - 32px);max-height:90vh;overflow-y:auto;">
      <h3 style="margin-top:0;margin-bottom:10px;color:#1976d2;font-size:1rem;">매출 검색</h3>
      <form id="sales-search-form">
        <div style="margin-bottom:6px;">
          <label style="display:flex;align-items:center;gap:6px;font-size:0.8rem;color:#666;font-weight:600;cursor:pointer;">
            <input type="checkbox" id="sales-search-all" style="width:16px;height:16px;cursor:pointer;" />
            <span>전체</span>
          </label>
        </div>
        <div style="margin-bottom:6px;">
          <label style="display:block;margin-bottom:1px;font-size:0.8rem;color:#666;font-weight:600;">시작일</label>
          <input type="date" id="sales-search-start-date" style="width:200px;max-width:100%;padding:4px 6px;border:1px solid #ddd;border-radius:4px;font-size:0.85rem;" />
        </div>
        <div style="margin-bottom:6px;">
          <label style="display:block;margin-bottom:1px;font-size:0.8rem;color:#666;font-weight:600;">종료일</label>
          <input type="date" id="sales-search-end-date" style="width:200px;max-width:100%;padding:4px 6px;border:1px solid #ddd;border-radius:4px;font-size:0.85rem;" />
        </div>
        <div style="margin-bottom:8px;">
          <label style="display:block;margin-bottom:1px;font-size:0.8rem;color:#666;font-weight:600;">회원명</label>
          <input type="text" id="sales-search-member-name" placeholder="회원명 입력 (선택)" style="width:200px;max-width:100%;padding:4px 6px;border:1px solid #ddd;border-radius:4px;font-size:0.85rem;" />
        </div>
        <div id="sales-search-result" style="min-height:16px;margin-bottom:6px;font-size:0.75rem;color:#666;"></div>
        <div style="display:flex;justify-content:space-between;gap:8px;">
          <button type="button" id="sales-search-cancel-btn" style="background:#eee;color:#333;border:none;padding:6px 12px;border-radius:4px;cursor:pointer;font-size:0.85rem;">취소</button>
          <button type="submit" style="background:#1976d2;color:#fff;border:none;padding:6px 12px;border-radius:4px;cursor:pointer;font-size:0.85rem;">검색</button>
        </div>
      </form>
    </div>

    <!-- 매니저 상세 모달 -->
    <div id="manager-detail-modal-bg" style="display:none;position:fixed;z-index:1000;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.25);"></div>
    <div id="manager-detail-modal" style="display:none;position:fixed;z-index:1001;top:50%;left:50%;transform:translate(-50%,-50%);background:#fff;padding:16px;border-radius:8px;box-shadow:0 8px 32px rgba(0,0,0,0.2);min-width:280px;max-width:90vw;">
      <div id="manager-detail-content" style="font-size:0.9rem;color:#333;white-space:nowrap;">
        매니저:<span id="manager-payment-amount" style="font-weight:600;margin:0 8px;">0원</span>
        - 매니저지출:<span id="manager-expense-amount" style="font-weight:600;margin:0 8px;">0원</span>
        = <span id="manager-difference" style="font-weight:700;color:#1976d2;margin-left:4px;">0원</span>
      </div>
      <div style="display:flex;justify-content:flex-end;margin-top:12px;">
        <button id="manager-detail-close-btn" style="background:#1976d2;color:#fff;border:none;padding:6px 12px;border-radius:4px;cursor:pointer;font-size:0.85rem;">닫기</button>
      </div>
    </div>

    <!-- 회원 삭제 모달 -->
    <div id="memberDeleteModalBg" style="display:none;position:fixed;z-index:1000;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.25);"></div>
    <div id="memberDeleteModal" style="display:none;position:fixed;z-index:1001;top:50%;left:50%;transform:translate(-50%,-50%);background:#fff;padding:24px;border-radius:14px;box-shadow:0 8px 32px #1976d240;min-width:400px;max-width:90vw;max-height:80vh;overflow-y:auto;">
      <h3 style="margin-top:0;margin-bottom:18px;color:#d32f2f;font-size:1.15rem;">회원 삭제</h3>
      <div id="memberSearchSection">
        <div class="form-row">
          <label for="memberNameInput">회원 이름</label>
          <input type="text" id="memberNameInput" name="memberName" placeholder="삭제할 회원 이름을 입력하세요" required>
        </div>
        <div style="display:flex;gap:10px;justify-content:flex-end;margin-top:10px;">
          <button type="button" id="closeMemberDeleteBtn" style="background:#eee;color:#1976d2;">취소</button>
          <button type="button" id="searchMemberBtn" style="background:#1976d2;color:#fff;">검색</button>
        </div>
      </div>
      <div id="memberInfoSection" style="display:none;">
        <div style="border:1px solid #ddd;border-radius:8px;padding:12px;margin:12px 0;background:#f9f9f9;">
          <h4 style="margin-top:0;margin-bottom:8px;color:#1976d2;font-size:1rem;">회원 정보</h4>
          <div id="memberInfoContent" style="font-size:0.9rem;"></div>
        </div>
        <div style="border:1px solid #ddd;border-radius:8px;padding:12px;margin:12px 0;background:#fff3cd;">
          <h4 style="margin-top:0;margin-bottom:8px;color:#856404;font-size:1rem;">세션 정보</h4>
          <div id="memberSessionInfoContent" style="font-size:0.9rem;"></div>
        </div>
        <div style="display:flex;gap:10px;justify-content:flex-end;margin-top:16px;padding-top:12px;border-top:1px solid #eee;">
          <button type="button" id="cancelDeleteBtn" style="background:#eee;color:#1976d2;">취소</button>
          <button type="button" id="confirmDeleteBtn" style="background:#d32f2f;color:#fff;">삭제 확인</button>
        </div>
      </div>
    </div>

    <!-- 세션 삭제 모달 -->
    <div id="sessionDeleteModalBg" style="display:none;position:fixed;z-index:1000;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.25);"></div>
    <div id="sessionDeleteModal" style="display:none;position:fixed;z-index:1001;top:50%;left:50%;transform:translate(-50%,-50%);background:#fff;padding:24px;border-radius:14px;box-shadow:0 8px 32px #1976d240;min-width:400px;max-width:90vw;max-height:80vh;overflow-y:auto;">
      <h3 style="margin-top:0;margin-bottom:18px;color:#d32f2f;font-size:1.15rem;">세션 삭제</h3>
      <div id="sessionSearchSection">
        <div class="form-row">
          <label for="sessionMemberNameInput">회원 이름</label>
          <input type="text" id="sessionMemberNameInput" name="sessionMemberName" placeholder="삭제할 세션의 회원 이름을 입력하세요" required>
        </div>
        <div class="form-row">
          <label for="sessionDateInput">날짜</label>
          <input type="date" id="sessionDateInput" name="sessionDate" required>
        </div>
        <div class="form-row">
          <label for="sessionTimeInput">시간</label>
          <select id="sessionTimeInput" name="sessionTime" required>
            <option value="">시간 선택</option>
            <option value="06:00">06:00</option>
            <option value="06:30">06:30</option>
            <option value="07:00">07:00</option>
            <option value="07:30">07:30</option>
            <option value="08:00">08:00</option>
            <option value="08:30">08:30</option>
            <option value="09:00">09:00</option>
            <option value="09:30">09:30</option>
            <option value="10:00">10:00</option>
            <option value="10:30">10:30</option>
            <option value="11:00">11:00</option>
            <option value="11:30">11:30</option>
            <option value="12:00">12:00</option>
            <option value="12:30">12:30</option>
            <option value="13:00">13:00</option>
            <option value="13:30">13:30</option>
            <option value="14:00">14:00</option>
            <option value="14:30">14:30</option>
            <option value="15:00">15:00</option>
            <option value="15:30">15:30</option>
            <option value="16:00">16:00</option>
            <option value="16:30">16:30</option>
            <option value="17:00">17:00</option>
            <option value="17:30">17:30</option>
            <option value="18:00">18:00</option>
            <option value="18:30">18:30</option>
            <option value="19:00">19:00</option>
            <option value="19:30">19:30</option>
            <option value="20:00">20:00</option>
            <option value="20:30">20:30</option>
            <option value="21:00">21:00</option>
            <option value="21:30">21:30</option>
            <option value="22:00">22:00</option>
          </select>
        </div>
        <div style="display:flex;gap:10px;justify-content:flex-end;margin-top:10px;">
          <button type="button" id="closeSessionDeleteBtn" style="background:#eee;color:#1976d2;">취소</button>
          <button type="button" id="searchSessionBtn" style="background:#1976d2;color:#fff;">검색</button>
        </div>
      </div>
      <div id="sessionInfoSection" style="display:none;">
        <div style="border:1px solid #ddd;border-radius:8px;padding:12px;margin:12px 0;background:#f9f9f9;">
          <h4 style="margin-top:0;margin-bottom:8px;color:#1976d2;font-size:1rem;">세션 정보</h4>
          <div id="sessionInfoContent" style="font-size:0.9rem;"></div>
        </div>
        <div style="display:flex;gap:10px;justify-content:flex-end;margin-top:16px;padding-top:12px;border-top:1px solid #eee;">
          <button type="button" id="cancelSessionDeleteBtn" style="background:#eee;color:#1976d2;">취소</button>
          <button type="button" id="confirmSessionDeleteBtn" style="background:#d32f2f;color:#fff;">삭제 확인</button>
        </div>
      </div>
    </div>

    <!-- 월별 통계 초기화 모달 -->
    <div id="monthlyStatsResetModalBg" style="display:none;position:fixed;z-index:1000;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.25);"></div>
    <div id="monthlyStatsResetModal" style="display:none;position:fixed;z-index:1001;top:50%;left:50%;transform:translate(-50%,-50%);background:#fff;padding:24px;border-radius:14px;box-shadow:0 8px 32px #1976d240;min-width:400px;max-width:90vw;">
      <h3 style="margin-top:0;margin-bottom:18px;color:#d32f2f;font-size:1.15rem;">월별 통계 초기화</h3>
      <div id="monthlyStatsResetSection">
        <div class="form-row">
          <label for="yearMonthInput">연도-월</label>
          <input type="text" id="yearMonthInput" name="yearMonth" placeholder="YYYY-MM (예: 2025-01)" required>
        </div>
        <div style="margin:12px 0;padding:12px;background:#fff3cd;border-radius:8px;border:1px solid #ffeaa7;">
          <div style="font-size:0.9rem;color:#856404;">
            <strong>⚠️ 주의사항:</strong><br>
            • 해당 월의 모든 세션 통계가 0으로 초기화됩니다.<br>
            • 신규 세션과 재등록 세션 모두 0이 됩니다.<br>
            • 이 작업은 되돌릴 수 없습니다.
          </div>
        </div>
        <div style="display:flex;gap:10px;justify-content:flex-end;margin-top:16px;">
          <button type="button" id="closeMonthlyStatsResetBtn" style="background:#eee;color:#1976d2;">취소</button>
          <button type="button" id="resetMonthlyStatsBtn" style="background:#d32f2f;color:#fff;">초기화 실행</button>
        </div>
      </div>
    </div>

    <!-- 지출 내역 추가 모달 -->
    <div id="expenseAddModalBg" class="tmc-modal-bg" style="display:none;"></div>
    <div id="expenseAddModal" class="tmc-modal" style="display:none;">
      <div class="tmc-modal-content">
        <div class="tmc-modal-header">
          <h3>💳 지출 내역 등록</h3>
          <button class="tmc-modal-close-btn" id="expenseAddModalCloseX" aria-label="닫기">×</button>
        </div>
        <form id="expenseAddForm" class="tmc-modal-form">
          <div class="tmc-form-group">
          <label>지출 유형 *</label>
            <div class="tmc-radio-group">
              <label class="tmc-radio-label">
                <input type="radio" name="expense-type" value="meal" id="expense-type-meal" checked>
                <span>식대</span>
            </label>
              <label class="tmc-radio-label">
                <input type="radio" name="expense-type" value="purchase" id="expense-type-purchase">
                <span>구매</span>
            </label>
              <label class="tmc-radio-label">
                <input type="radio" name="expense-type" value="personal" id="expense-type-personal">
                <span>개인지출</span>
            </label>
          </div>
        </div>
          <div class="tmc-form-group">
          <label for="expense-datetime">시각 *</label>
          <input type="datetime-local" id="expense-datetime" name="datetime" required>
        </div>
          <div id="expense-purchase-item-row" class="tmc-form-group" style="display:none;">
          <label for="expense-purchase-item">구매물품 *</label>
          <input type="text" id="expense-purchase-item" name="purchase-item" placeholder="구매물품명을 입력하세요">
        </div>
          <div id="expense-personal-item-row" class="tmc-form-group" style="display:none;">
          <label for="expense-personal-item">지출내역 *</label>
          <input type="text" id="expense-personal-item" name="personal-item" placeholder="지출내역을 입력하세요">
        </div>
          <div class="tmc-form-group">
          <label for="expense-amount">금액 *</label>
            <input type="text" id="expense-amount" name="amount" placeholder="원" inputmode="numeric" required>
        </div>
          <div id="expense-trainers-row" class="tmc-form-group">
            <label class="tmc-label-top">함께한 트레이너 *</label>
            <div id="expense-trainers-list" class="tmc-trainers-list"></div>
        </div>
          <div id="expense-center-row" class="tmc-form-group" style="display:none;">
          <label for="expense-center">센터 *</label>
            <select id="expense-center" name="center">
            <option value="">센터를 선택하세요</option>
          </select>
        </div>
          <div id="expense-personal-center-row" class="tmc-form-group" style="display:none;">
          <label for="expense-personal-center">센터 *</label>
            <select id="expense-personal-center" name="personal-center">
            <option value="">센터를 선택하세요</option>
          </select>
        </div>
          <div id="expenseAddResult" class="tmc-modal-result"></div>
        </form>
        <div class="tmc-modal-actions">
          <button type="submit" form="expenseAddForm" class="tmc-modal-submit-btn">등록</button>
        </div>
      </div>
    </div>
    <!-- 상담기록 목록 모달 -->
    <div id="consultationListModalBg" class="tmc-modal-bg" style="display:none;"></div>
    <div id="consultationListModal" class="tmc-modal" style="display:none;">
      <div class="tmc-modal-content">
        <div class="tmc-modal-header">
          <h3>📋 상세상담 목록</h3>
          <button class="tmc-modal-close-btn" id="consultationListModalCloseX" aria-label="닫기">×</button>
        </div>
        <div class="tmc-modal-form" style="padding: 8px 12px;">
          <!-- 필터 영역 -->
          <div class="consultation-filter-row">
            <div class="consultation-filter-item">
              <label>센터</label>
              <select id="consultation-list-filter-center">
                <option value="">전체</option>
              </select>
            </div>
            <div class="consultation-filter-item">
              <label>트레이너</label>
              <select id="consultation-list-filter-trainer">
                <option value="">전체</option>
              </select>
            </div>
            <div class="consultation-filter-item">
              <label>월</label>
              <input type="month" id="consultation-list-filter-month">
            </div>
          </div>
          
          <!-- 목록 영역 -->
          <div style="max-height: calc(90vh - 250px); overflow-x: auto; overflow-y: auto;">
            <table style="width: 100%; border-collapse: collapse; font-size: 12px;">
              <thead style="position: sticky; top: 0; background: var(--trainer-surface); z-index: 10;">
                <tr style="border-bottom: 2px solid var(--trainer-border);">
                  <th style="padding: 8px; text-align: left; font-weight: 600;">날짜</th>
                  <th style="padding: 8px; text-align: left; font-weight: 600;">센터</th>
                  <th style="padding: 8px; text-align: left; font-weight: 600;">트레이너</th>
                  <th style="padding: 8px; text-align: left; font-weight: 600;">이름</th>
                  <th style="padding: 8px; text-align: left; font-weight: 600;">연락처</th>
                  <th style="padding: 8px; text-align: left; font-weight: 600;">상담목적</th>
                </tr>
              </thead>
              <tbody id="consultation-list-tbody">
                <tr>
                  <td colspan="6" style="padding: 20px; text-align: center; color: var(--trainer-text-muted);">조회 버튼을 눌러 상담기록을 불러오세요.</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        <div class="tmc-modal-actions">
          <button type="button" id="consultation-list-add-btn" class="tmc-modal-submit-btn">추가</button>
        </div>
      </div>
    </div>
    
    <!-- 상담기록지 입력 모달 -->
    <div id="consultationModalBg" class="tmc-modal-bg" style="display:none;"></div>
    <div id="consultationModal" class="tmc-modal" style="display:none;">
      <div class="tmc-modal-content">
        <div class="tmc-modal-header">
          <h3>📋 상담기록지</h3>
          <button class="tmc-modal-close-btn" id="consultationModalCloseX" aria-label="닫기">×</button>
        </div>
        <form id="consultationForm" class="tmc-modal-form">
          <!-- 기본정보 섹션 -->
          <div class="consultation-section">
            <div class="consultation-section-title">기본정보</div>
            <div class="consultation-trainer-center-row">
              <div class="tmc-form-group">
                <label for="consultation-center">센터 *</label>
                <select id="consultation-center" name="center" required>
                  <option value="">센터를 선택하세요</option>
                </select>
              </div>
              <div class="tmc-form-group">
                <label for="consultation-trainer">담당 트레이너 *</label>
                <select id="consultation-trainer" name="trainer_username" required>
                  <option value="">트레이너를 선택하세요</option>
                </select>
              </div>
            </div>
            <div class="consultation-basic-info">
              <div class="tmc-form-group">
                <label for="consultation-name">이름 *</label>
                <input type="text" id="consultation-name" name="name" required>
              </div>
              <div class="tmc-form-group">
                <label for="consultation-phone">연락처</label>
                <input type="text" id="consultation-phone" name="phone">
              </div>
              <div class="tmc-form-group">
                <label for="consultation-gender">성별</label>
                <select id="consultation-gender" name="gender">
                  <option value="">선택</option>
                  <option value="M">남성</option>
                  <option value="F">여성</option>
                  <option value="기타">기타</option>
                </select>
              </div>
              <div class="tmc-form-group">
                <label for="consultation-age-range">연령대</label>
                <select id="consultation-age-range" name="age_range">
                  <option value="">선택</option>
                  <option value="10대">10대</option>
                  <option value="20대">20대</option>
                  <option value="30대">30대</option>
                  <option value="40대">40대</option>
                  <option value="50대">50대</option>
                  <option value="60대 이상">60대 이상</option>
                  <option value="모름">모름</option>
                </select>
              </div>
              <div class="tmc-form-group consultation-full-width">
                <label for="consultation-exercise-history">운동이력</label>
                <textarea id="consultation-exercise-history" name="exercise_history" rows="2"></textarea>
              </div>
              <div class="tmc-form-group consultation-full-width">
                <label for="consultation-medical-history">병력</label>
                <textarea id="consultation-medical-history" name="medical_history" rows="2"></textarea>
              </div>
            </div>
            <div class="consultation-trainer-center-row">
              <div class="tmc-form-group">
                <label for="consultation-visit-source">방문경로</label>
                <select id="consultation-visit-source" name="visit_source">
                  <option value="">선택</option>
                  <option value="워크인">워크인</option>
                  <option value="지인소개">지인소개</option>
                  <option value="네이버지도">네이버지도</option>
                  <option value="네이버블로그">네이버블로그</option>
                  <option value="당근">당근</option>
                  <option value="홍보물">홍보물</option>
                  <option value="배너">배너</option>
                  <option value="간판">간판</option>
                  <option value="모름">모름</option>
                </select>
              </div>
              <div class="tmc-form-group">
                <label for="consultation-visit-reason">방문이유</label>
                <input type="text" id="consultation-visit-reason" name="visit_reason" placeholder="예: 집에서 가장 가까움">
              </div>
            </div>
            <div class="consultation-basic-info">
              <div class="tmc-form-group consultation-full-width">
                <label for="consultation-preferred-time">희망시간대</label>
                <input type="text" id="consultation-preferred-time" name="preferred_time" placeholder="예: 평일 저녁">
              </div>
              <div class="tmc-form-group consultation-full-width">
                <label for="consultation-referrer">추천인</label>
                <input type="text" id="consultation-referrer" name="referrer">
              </div>
            </div>
          </div>
          
          <!-- 상담목적 섹션 -->
          <div class="consultation-section">
            <div class="consultation-section-title">상담목적</div>
            <div class="tmc-form-group">
              <label for="consultation-purpose">상담목적</label>
              <select id="consultation-purpose" name="purpose">
                <option value="">선택</option>
                <option value="체력증진">체력증진</option>
                <option value="근력강화">근력강화</option>
                <option value="자세교정">자세교정</option>
                <option value="재활">재활</option>
                <option value="다이어트">다이어트</option>
                <option value="선수지망">선수지망</option>
                <option value="기타">기타</option>
              </select>
            </div>
            <div class="tmc-form-group" id="consultation-purpose-other-row" style="display:none;">
              <label for="consultation-purpose-other">상담목적 (기타 직접입력)</label>
              <input type="text" id="consultation-purpose-other" name="purpose_other">
            </div>
            <div class="tmc-form-group">
              <label for="consultation-requirements">요구사항</label>
              <input type="text" id="consultation-requirements" name="requirements" placeholder="요구사항을 입력하세요">
            </div>
          </div>
          
          <!-- 신체검사 - 기본검사 섹션 -->
          <div class="consultation-section">
            <div class="consultation-section-title">기본검사</div>
            <div class="tmc-form-group">
              <label for="consultation-inbody">인바디</label>
              <textarea id="consultation-inbody" name="inbody" rows="2"></textarea>
            </div>
            <div class="tmc-form-group">
              <label for="consultation-overhead-squat">오버헤드스쿼트</label>
              <textarea id="consultation-overhead-squat" name="overhead_squat" rows="2"></textarea>
            </div>
          </div>
          
          <!-- 신체검사 - 상세검사 섹션 -->
          <div class="consultation-section">
            <div class="consultation-section-title">상세검사</div>
            <div class="tmc-form-group">
              <label for="consultation-slr-test">SLR 테스트</label>
              <textarea id="consultation-slr-test" name="slr_test" rows="2"></textarea>
            </div>
            <div class="tmc-form-group">
              <label for="consultation-empty-can-test">Empty Can 테스트</label>
              <textarea id="consultation-empty-can-test" name="empty_can_test" rows="2"></textarea>
            </div>
            <div class="tmc-form-group">
              <label for="consultation-rom">가동범위</label>
              <textarea id="consultation-rom" name="rom" rows="2"></textarea>
            </div>
            <div class="tmc-form-group">
              <label for="consultation-flexibility">유연성</label>
              <textarea id="consultation-flexibility" name="flexibility" rows="2"></textarea>
            </div>
            <div class="tmc-form-group">
              <label for="consultation-static-posture">정적 자세평가</label>
              <textarea id="consultation-static-posture" name="static_posture" rows="2"></textarea>
            </div>
          </div>
          
          <!-- 수행운동 섹션 -->
          <div class="consultation-section">
            <div class="consultation-section-title">수행운동</div>
            <div class="tmc-form-group">
              <label for="consultation-exercise-performed">수행운동</label>
              <textarea id="consultation-exercise-performed" name="exercise_performed" rows="3"></textarea>
            </div>
          </div>
          
          <!-- 상담정리 섹션 -->
          <div class="consultation-section">
            <div class="consultation-section-title">상담정리</div>
            <div class="tmc-form-group">
              <label for="consultation-summary">종합평가</label>
              <textarea id="consultation-summary" name="summary" rows="3"></textarea>
            </div>
          </div>
          
          <!-- 동영상 섹션 -->
          <div class="consultation-section" id="consultation-video-section" style="display:none;">
            <div class="consultation-section-title">동영상 (최대 4개)</div>
            <div class="tmc-form-group">
              <label>동영상 업로드</label>
              <input type="file" id="consultation-video-upload" accept="video/mp4,video/quicktime,video/x-msvideo,video/webm" style="display:none;" multiple>
              <button type="button" id="consultation-video-select-btn" class="tmc-btn-secondary" style="margin-bottom: 10px;">동영상 선택</button>
              <div id="consultation-video-list" style="margin-top: 10px;"></div>
            </div>
          </div>
          
          <!-- 사진 섹션 -->
          <div class="consultation-section" id="consultation-image-section" style="display:none;">
            <div class="consultation-section-title">사진 (최대 4개)</div>
            <div class="tmc-form-group">
              <label>사진 업로드</label>
              <input type="file" id="consultation-image-upload" accept="image/jpeg,image/jpg,image/png,image/gif,image/webp" style="display:none;" multiple>
              <button type="button" id="consultation-image-select-btn" class="tmc-btn-secondary" style="margin-bottom: 10px;">사진 선택</button>
              <div id="consultation-image-list" style="margin-top: 10px;"></div>
            </div>
          </div>
          
          <div id="consultationResult" class="tmc-modal-result"></div>
        </form>
        <div class="tmc-modal-actions">
          <button type="button" id="consultationDeleteBtn" class="tmc-modal-delete-btn" style="display:none;">삭제</button>
          <button type="button" id="consultationCreateShareBtn" class="tmc-modal-share-btn" style="display:none;">상담지 링크 생성</button>
          <div style="display:flex;gap:6px;margin-left:auto;">
            <button type="button" id="consultationCancelBtn" class="tmc-modal-cancel-btn">취소</button>
            <button type="submit" form="consultationForm" class="tmc-modal-submit-btn">저장</button>
          </div>
        </div>
      </div>
    </div>
    <div id="mainSection">
        <div id="tabBar" class="tab-bar"></div>
        <div id="tabContent" class="tab-content"></div>
    </div>
    <!-- 앱 유저 섹션 -->
    <div id="app-user-section" style="display:none;"></div>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
    <script type="module" src="js/main.js"></script>
    <script type="module" src="js/adminDayCalendar.js"></script>
    <script type="module" src="js/secret.js"></script>
    <script type="module" src="js/expense.js"></script>
    <script type="module" src="js/consultation.js"></script>
    <script type="module" src="js/database.js"></script>
    <script>
        // Service Worker 등록
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then((registration) => {
                        console.log('[PWA] Service Worker 등록 성공:', registration.scope);
                        
                        // 업데이트 확인
                        registration.addEventListener('updatefound', () => {
                            const newWorker = registration.installing;
                            console.log('[PWA] 새로운 Service Worker 발견');
                            
                            newWorker.addEventListener('statechange', () => {
                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    // 새 버전이 설치되었음을 알림
                                    console.log('[PWA] 새로운 버전 사용 가능');
                                }
                            });
                        });
                    })
                    .catch((error) => {
                        console.error('[PWA] Service Worker 등록 실패:', error);
                    });
            });
            
            // Service Worker 업데이트 확인
            let refreshing = false;
            navigator.serviceWorker.addEventListener('controllerchange', () => {
                if (!refreshing) {
                    refreshing = true;
                    console.log('[PWA] Service Worker 업데이트, 페이지 새로고침');
                    // 페이지 새로고침 (선택사항)
                    // window.location.reload();
                }
            });
        }
    </script>
    
    <!-- 트레이너 프로필 사진 업로드 모달 -->
    <div id="trainerProfileImageModalBg" style="display:none;position:fixed;z-index:1000;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.5);"></div>
    <div id="trainerProfileImageModal" style="display:none;position:fixed;z-index:1001;top:50%;left:50%;transform:translate(-50%,-50%);background:#fff;padding:24px;border-radius:14px;box-shadow:0 8px 32px rgba(0,0,0,0.3);max-width:600px;width:90vw;max-height:90vh;overflow-y:auto;">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">
            <h3 style="margin:0;font-size:20px;font-weight:600;">📷 프로필 사진 업로드</h3>
            <button onclick="closeProfileImageModal()" style="background:none;border:none;font-size:24px;cursor:pointer;color:#666;padding:0;width:30px;height:30px;display:flex;align-items:center;justify-content:center;">×</button>
        </div>
        <div style="margin-bottom:16px;">
            <strong>트레이너:</strong> <span id="profileImageTrainerName"></span>
        </div>
        
        <!-- 파일 선택 영역 -->
        <div id="profileImageFileSelectArea" style="margin-bottom:16px;text-align:center;">
            <input type="file" id="profileImageFileInput" accept="image/*" style="display:none;" />
            <button onclick="document.getElementById('profileImageFileInput').click()" class="btn-primary" style="padding:10px 20px;border-radius:8px;border:none;background:#2196f3;color:#fff;cursor:pointer;font-weight:600;">
                파일 선택
            </button>
        </div>
        
        <!-- 이미지 크롭 영역 -->
        <div id="profileImageCropArea" style="display:none;margin-bottom:16px;">
            <div style="position:relative;max-width:100%;overflow:hidden;background:#f0f0f0;border:2px solid #ddd;border-radius:8px;">
                <canvas id="profileImageCropCanvas" style="display:block;max-width:100%;cursor:move;"></canvas>
                <div id="profileImageCropCircle" style="position:absolute;border:3px solid #2196f3;border-radius:50%;pointer-events:none;box-shadow:0 0 0 9999px rgba(0,0,0,0.5);"></div>
            </div>
            <div style="margin-top:8px;text-align:center;font-size:12px;color:#666;">
                드래그하여 이동 · 휠로 크기 조절
            </div>
        </div>
        
        <!-- 크롭된 미리보기 영역 -->
        <div id="profileImagePreviewArea" style="display:none;margin-bottom:16px;text-align:center;">
            <div style="margin-bottom:8px;font-weight:600;">미리보기</div>
            <canvas id="profileImagePreviewCanvas" style="width:150px;height:150px;border-radius:50%;border:2px solid #ddd;"></canvas>
        </div>
        
        <!-- 현재 프로필 사진 표시 (파일 선택 전) -->
        <div id="profileImageCurrentPreview" style="margin-bottom:16px;text-align:center;">
            <img id="profileImageCurrentImg" src="" alt="현재 프로필" style="width:150px;height:150px;object-fit:cover;border-radius:50%;border:2px solid #ddd;display:none;" />
            <div id="profileImageCurrentPlaceholder" style="width:150px;height:150px;background:#e0e0e0;border-radius:50%;margin:0 auto;display:flex;align-items:center;justify-content:center;">
                <span style="font-size:48px;">👤</span>
            </div>
        </div>
        
        <div id="profileImageResult" style="margin-bottom:16px;"></div>
        
        <div style="display:flex;gap:8px;justify-content:flex-end;">
            <button onclick="uploadProfileImage()" class="btn-primary" id="uploadProfileImageBtn" style="display:none;padding:10px 20px;border-radius:8px;border:none;background:#2196f3;color:#fff;cursor:pointer;font-weight:600;">업로드</button>
            <button onclick="deleteProfileImage()" class="btn-danger" id="deleteProfileImageBtn" style="display:none;padding:10px 20px;border-radius:8px;border:none;background:#d32f2f;color:#fff;cursor:pointer;font-weight:600;">삭제</button>
            <button onclick="closeProfileImageModal()" class="btn-secondary" style="padding:10px 20px;border-radius:8px;border:1px solid #ddd;background:#fff;color:#333;cursor:pointer;font-weight:600;">취소</button>
        </div>
    </div>
</body>
</html>
